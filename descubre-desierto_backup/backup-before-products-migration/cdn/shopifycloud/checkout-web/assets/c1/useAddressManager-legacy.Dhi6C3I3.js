!function(){function e(e,r){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);r&&(d=d.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),s.push.apply(s,d)}return s}function r(r){for(var d=1;d<arguments.length;d++){var t=null!=arguments[d]?arguments[d]:{};d%2?e(Object(t),!0).forEach((function(e){s(r,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):e(Object(t)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))}))}return r}function s(e,r,s){return(r=function(e){var r=function(e){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof r?r:r+""}(r))in e?Object.defineProperty(e,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[r]=s,e}function d(e,r,s,d,t,n,i){try{var a=e[n](i),o=a.value}catch(e){return void s(e)}a.done?r(o):Promise.resolve(o).then(d,t)}function t(e){return function(){var r=this,s=arguments;return new Promise((function(t,n){var i=e.apply(r,s);function a(e){d(i,t,n,a,o,"next",e)}function o(e){d(i,t,n,a,o,"throw",e)}a(void 0)}))}}System.register(["./app-legacy.8MsYkguj.js","./useShopPayPaymentRequiredMethod-legacy.Dvg6VSjL.js"],(function(e,d){"use strict";var n,i,a,o,u,l,c,p,f,h,v,y,m,g,b,A,_,P,k,C,$,x,S,E,O,j,w;return{setters:[e=>{n=e.Z,i=e.s,a=e.ec,o=e.k,u=e.eV,l=e.eW,c=e.i,p=e.z,f=e.eX,h=e.eY,v=e.J,y=e.eZ,m=e.e_,g=e.e$,b=e.f0,A=e.dx,_=e.f1,P=e.f2,k=e.f3,C=e.ee,$=e.b9,x=e.eg,S=e.f4,E=e.ek},e=>{O=e.a,j=e.b,w=e.u}],execute:function(){function d(e){var r,s,d;const{geolocation:t}=n(),l=i.phoneNumber.value,c=i.addresses.value,p=a(),f=null===(r=c[0])||void 0===r?void 0:r.address,h=null!==(s=null===(d=p.defaultShippingDetails.country)||void 0===d?void 0:d.code)&&void 0!==s?s:t.country.code;return o((()=>{if(e)return u(e.address);const r={firstName:null==f?void 0:f.firstName,lastName:null==f?void 0:f.lastName,phone:l,countryCode:(null==f?void 0:f.countryCode)||h,zoneCode:null==f?void 0:f.zoneCode};return u(r)}),[e,f,h,l])}e({a:d,u:function(e="shipping_address"){const{monorail:s,source:n,checkout:a,shop:u}=c(),q=function(){const e=l(),r=O(),{telemetryClient:s}=c();return p(function(){var d=t((function*(d,t,n=r,i=!1){const{data:a,error:o}=yield e.mutate(D,{variables:{address:f(d),origin:n,checkoutContext:t,preferred:i}});if(o||null==a||null==a.addressCreate)return s.leaveErrorBreadcrumb("Shop Pay add address mutation had an error"),{status:"failed"};const{addressCreate:u}=a;return u.userErrors.length>0?(s.leaveErrorBreadcrumb("Shop Pay add address mutation had a user error"),{status:"failed",errors:u.userErrors}):{status:"success",address:u.userAddress?h(u.userAddress):void 0}}));return function(e,r){return d.apply(this,arguments)}}(),[r,e,s])}(),F=function(){const e=l(),r=O(),{telemetryClient:s}=c();return p(function(){var d=t((function*(d,t,n,i=!1){const{data:a,error:o}=yield e.mutate(N,{variables:{id:t,address:f(d),origin:r,preferred:i,checkoutContext:n}});if(o||null==a||null==a.addressUpdate)return s.leaveErrorBreadcrumb("Shop Pay update address mutation had an error"),{status:"failed"};const{addressUpdate:u}=a;return u.userErrors.length>0?(s.leaveErrorBreadcrumb("Shop Pay update address mutation had a user error"),{status:"failed",errors:u.userErrors}):{status:"success",address:u.userAddress?h(u.userAddress):void 0}}));return function(e,r,s){return d.apply(this,arguments)}}(),[e,r,s])}(),T=function(){const e=l(),r=O();return p(function(){var s=t((function*(s,d){const{data:t,error:n}=yield e.mutate(I,{variables:{id:s,origin:r,checkoutContext:d}});if(n||null==t||null==t.addressDelete)return{status:"failed"};const{addressDelete:i}=t;return i.userErrors.length>0?{status:"failed",errors:i.userErrors}:{status:"success"}}));return function(e,r){return s.apply(this,arguments)}}(),[e,r])}(),[V,z]=v(),[R,M]=y(),[Z,J]=m(),[W,X]=g(),[Y,G]=b(),{shippingRequired:H}=A(),K=j(),[L]=_(),{updateCheckoutAddress:Q}=P(),ee=d(),{shop:{id:re,myshopifyDomain:se},source:{checkoutSessionIdentifier:de}}=c(),{cashbackState:te}=k(),ne=p((()=>{te.stale.value=!0}),[te]),ie=C(),ae=i.explicitlyPreferredShippingAddressId,oe=w(),ue=x({paymentRequiredMethod:oe,isIdealEnabledForShopPay:ie}),le=O(),ce=o((()=>({checkoutIdentifier:de,checkoutVersion:le,shopId:$(re),shopifyDomain:se})),[de,re,se,le]),pe=p(function(){var e=t((function*(e,s){if(0===V.length)throw new U("There are no shipping addresses to update!");const d=yield F(e,s,ce,!0);if("success"===d.status&&d.address){const e=V.map((e=>e.id===s?d.address:r(r({},e),{},{userPreferred:!1})));z(e),ae.value=s}return d}));return function(r,s){return e.apply(this,arguments)}}(),[V,F,z,ae,ce]),fe=p(function(){var e=t((function*(e,s,d=!1,t=!1){const n=yield q(e,ce,t?"merchant_defined":le);if("success"===n.status&&n.address){let e=!1;z([...V,n.address]);const t={};(H&&!R||"shipping_address"===s)&&(M(n.address),t.shippingAddress=B(n.address.address)),ue&&(G(n.address),t.billingAddress=n.address.address,e=H),(!Z||"billing_address"===s&&K)&&(J(n.address),K&&(t.billingAddress=n.address.address)),W&&("billing_address"!==s||K)||X(n.address),d||(yield Q(r(r({},t),{},{fallbackPhoneNumber:L}),e)),ne()}return n}));return function(r,s){return e.apply(this,arguments)}}(),[le,q,z,V,H,R,Z,K,W,M,G,J,X,Q,L,ue,ce,ne]),he=p(function(){var e=t((function*(e,s){if(0===V.length)throw new U("There are no shipping addresses to update!");const d=yield F(e,s,ce);if("success"===d.status&&d.address){const e=V.findIndex((e=>e.id===s)),t=[...V];t[e]=d.address,z(t);let n=!1;const i={};(null==R?void 0:R.id)===d.address.id&&(M(d.address),i.shippingAddress=B(d.address.address)),(null==Y?void 0:Y.id)===d.address.id&&(G(d.address),ue&&(i.billingAddress=d.address.address,n=H)),(null==Z?void 0:Z.id)===d.address.id&&(J(d.address),K&&(i.billingAddress=d.address.address)),(null==W?void 0:W.id)===s&&X(d.address),yield Q(r(r({},i),{},{fallbackPhoneNumber:L}),n),Object.keys(i).length>0&&ne()}return d}));return function(r,s){return e.apply(this,arguments)}}(),[V,F,z,null==R?void 0:R.id,null==Y?void 0:Y.id,null==Z?void 0:Z.id,null==W?void 0:W.id,Q,L,M,G,H,J,K,X,ue,ce,ne]),ve=p(function(){var e=t((function*(e){if("success"===(yield T(e,ce)).status){const i=V.find((r=>r.id===e)),o=V.filter((r=>r.id!==e)),l=S(o);let c=!1;if(null!=i&&i.userPreferred&&l){s.record({schemaId:"shopify_pay_payment_page_ui_interaction/1.2",payload:r(r({},E(n,a,u)),{},{action:"set_default_address_auto"})});const e=o.findIndex((e=>e.id===l.id));ae.value=l.id,o[e]=r(r({},o[e]),{},{address:r({},o[e].address),userPreferred:!0})}z(o);const p={};var d,t;(null==R?void 0:R.id)===e&&(M(null!=l?l:void 0),p.shippingAddress=null!=l&&l.address?B(l.address):B(ee.value)),(null==Y?void 0:Y.id)===e&&(G(null!=l?l:void 0),ue&&(p.billingAddress=null!==(d=null==l?void 0:l.address)&&void 0!==d?d:ee.value,c=H)),(null==Z?void 0:Z.id)===e&&(J(null!=l?l:void 0),K&&(p.billingAddress=null!==(t=null==l?void 0:l.address)&&void 0!==t?t:ee.value)),(null==W?void 0:W.id)===e&&X(null!=l?l:void 0),yield Q(r(r({},p),{},{fallbackPhoneNumber:L}),c)}}));return function(r){return e.apply(this,arguments)}}(),[T,V,z,null==R?void 0:R.id,null==Y?void 0:Y.id,null==Z?void 0:Z.id,null==W?void 0:W.id,Q,L,s,n,a,u,ae,M,ee,G,H,J,K,X,ue,ce]),ye=p(function(){var e=t((function*(e,s){const d={negotiateType:"async"};let t=!1;"shipping_address"===s?(M(e),d.shippingAddress=B(e.address)):K?(J(e),d.billingAddress=e.address):ue?(G(e),d.billingAddress=e.address,t=H):X(e),yield Q(r(r({},d),{},{fallbackPhoneNumber:L}),t)}));return function(r,s){return e.apply(this,arguments)}}(),[K,Q,L,M,J,X,G,H,ue]);return{selectedAddress:o((()=>"shipping_address"===e?R:ue?Y:K?Z:W),[e,K,Z,W,R,Y,ue]),setSelectedAddress:ye,saveAddress:fe,updateAddress:he,deleteAddress:ve,setDefaultAddress:pe,isAddressPreferred:p((e=>e===ae.value),[ae])}}});const D={id:"a297506f76e8d76e47aba27ad157a3b3010bca436de1afc02a61cc7474d2b461",type:"mutation",name:"AddressCreate",source:"mutation AddressCreate($address:AddressInput!,$checkoutContext:CheckoutContextInput!,$origin:String!,$preferred:Boolean){addressCreate(address:$address origin:$origin checkoutContext:$checkoutContext preferred:$preferred){userErrors{message field __typename}userAddress{...ShippingAddressFragment __typename}__typename}}fragment ShippingAddressFragment on Address{fields{key value __typename}id uuid lastUsedAt requiresVerification valid userPreferred explicitlyPreferred __typename}"},I={id:"838b6474da69da7a0325eb13ac94541fb070a7d544e396727b76a9fdf5ce0339",type:"mutation",name:"AddressDelete",source:"mutation AddressDelete($id:ID!,$origin:String!,$checkoutContext:CheckoutContextInput!){addressDelete(id:$id,origin:$origin,checkoutContext:$checkoutContext){userErrors{field message __typename}__typename}}"},N={id:"968d0b795a56fbe1e91e6c6c73d4dae352811b2b58904129e1400085dcb6ec59",type:"mutation",name:"AddressUpdate",source:"mutation AddressUpdate($address:AddressInput!,$id:ID!,$origin:String!,$preferred:Boolean,$checkoutContext:CheckoutContextInput!){addressUpdate(address:$address id:$id origin:$origin preferred:$preferred checkoutContext:$checkoutContext){userErrors{field message __typename}userAddress{...ShippingAddressFragment __typename}__typename}}fragment ShippingAddressFragment on Address{fields{key value __typename}id uuid lastUsedAt requiresVerification valid userPreferred explicitlyPreferred __typename}"};class U extends Error{constructor(...e){super(...e),s(this,"name","CannotUpdateAddressError")}}const B=e=>r(r({},e),{},{coordinates:e.coordinates})}}}))}();

!function(){function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function t(t){for(var r=1;r<arguments.length;r++){var o=null!=arguments[r]?arguments[r]:{};r%2?e(Object(o),!0).forEach((function(e){n(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function n(e,t,n){return(t=function(e){var t=function(e){if("object"!=typeof e||!e)return e;var t=e[Symbol.toPrimitive];if(void 0!==t){var n=t.call(e,"string");if("object"!=typeof n)return n;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}System.register(["./app-legacy.CVtZXpP_.js","./SeparatePaymentsNotice-legacy.DaQsUWPz.js","./ShopPayOptInDisclaimer-legacy.BG6XXIar.js"],(function(e,n){"use strict";var r,o,i,a,c,s,u,l,p,f,y,b,d,m,g,v,P,h,_,O,E,T,S,A,j,w;return{setters:[e=>{r=e.N,o=e.b0,i=e.b1,a=e.i,c=e.b2,s=e.a,u=e.b3,l=e.R,p=e.V,f=e.an,y=e.W,b=e.b4,d=e.aS,m=e.b5,g=e.b6,v=e.ah,P=e.b7,h=e.aF,_=e.z,O=e.aN,E=e.b8,T=e.b9,S=e.ba},e=>{A=e.R,j=e.S},e=>{w=e.S}],execute:function(){e("P",(function(){const e=r("Checkout::Actions::RenderBefore"),t=o(),{PayButton:d}=i(),{offsitePopupController:m}=a();return c((()=>{if(m.isOpen.value){const e=function(){const e=document.createElement("style");return e.setAttribute("id",C),e.textContent=`\n    #${N}, #${N} * {\n      view-transition-name: none !important;\n    }\n  `,document.head.appendChild(e),e}();return()=>{e.remove()}}})),s(b,{target:"cart.paymentLines[0]",children:s(u,{impressionType:"pay_now_button",impressionFeatures:[],children:[0!==e.length&&s(l,{children:[s(p,{extensions:e,render:n}),s(f,{spacing:"base"})]}),s(y,{ref:t,id:N,children:[s(D,{}),s(A,{children:s(d,{})}),s(w,{}),s(j,{})]})]})})}));const n=e=>s(d,{children:e}),C="disable-view-transitions-for-pay-button-section",N="checkout-pay-button-section",M=new Map([["PAYMENTS_UNACCEPTABLE_PAYMENT_AMOUNT",{status:"warning",priority:-1,negotiationStage:"completion"}],["TAX_NEW_TAX_MUST_BE_ACCEPTED",{status:"warning",priority:-2,negotiationStage:"completion"}]]);function D(){const e=function(e,n){const r=P(),[o,i]=h([]),a=_((({violations:e,negotiationStage:r})=>{const o=[],i=e.some((e=>S.has(e.code)));for(const a of e)if(!U(a)&&(!i||"PAYMENTS_UNACCEPTABLE_PAYMENT_AMOUNT"!==a.code&&"TAX_NEW_TAX_MUST_BE_ACCEPTED"!==a.code)&&n.has(a.code)){if(i)continue;const e=n.get(a.code);r&&r===(null==e?void 0:e.negotiationStage)&&o.push(t(t({},a),{},{tone:null==e?void 0:e.tone,priority:null==e?void 0:e.priority}))}if(o.length>=1){const e=0,t=o.map((t=>{var n;return null!==(n=t.priority)&&void 0!==n?n:e})).reduce(((e,t)=>e>t?e:t));return o.filter((n=>{var r;return(null!==(r=n.priority)&&void 0!==r?r:e)>=t}))}return o}),[n]);return O((()=>{e&&i(a({violations:e}))}),[a]),E((e=>{"complete"!==e.type&&"invalid"!==e.type&&"failed"!==e.type&&r.current&&i(a({violations:e.violations,negotiationStage:e.negotiationStage}))})),o.filter(T("localizedMessage"))}(m().value,M);return s(b,{target:"cart.paymentLines[0]",children:e.map((e=>s(g,{notice:e,errorType:v.PaymentError},e.code)))})}function U(e){return"ConfirmChangeViolation"!==e.__typename&&"UnprocessableTermViolation"!==e.__typename&&"RemoveTermViolation"!==e.__typename}}}}))}();

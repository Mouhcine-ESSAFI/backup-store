!function(){function e(e,r){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var d=Object.getOwnPropertySymbols(e);r&&(d=d.filter((function(r){return Object.getOwnPropertyDescriptor(e,r).enumerable}))),s.push.apply(s,d)}return s}function r(r){for(var d=1;d<arguments.length;d++){var t=null!=arguments[d]?arguments[d]:{};d%2?e(Object(t),!0).forEach((function(e){s(r,e,t[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(t)):e(Object(t)).forEach((function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(t,e))}))}return r}function s(e,r,s){return(r=function(e){var r=function(e){if("object"!=typeof e||!e)return e;var r=e[Symbol.toPrimitive];if(void 0!==r){var s=r.call(e,"string");if("object"!=typeof s)return s;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof r?r:r+""}(r))in e?Object.defineProperty(e,r,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[r]=s,e}function d(e,r,s,d,t,n,i){try{var a=e[n](i),o=a.value}catch(e){return void s(e)}a.done?r(o):Promise.resolve(o).then(d,t)}function t(e){return function(){var r=this,s=arguments;return new Promise((function(t,n){var i=e.apply(r,s);function a(e){d(i,t,n,a,o,"next",e)}function o(e){d(i,t,n,a,o,"throw",e)}a(void 0)}))}}System.register(["./app-legacy.CVtZXpP_.js","./useShopPayPaymentRequiredMethod-legacy.DC5RFglA.js"],(function(e,d){"use strict";var n,i,a,o,u,l,c,f,p,h,v,y,m,g,b,A,_,P,C,k,$,x,S,E,O,j,w;return{setters:[e=>{n=e.au,i=e.s,a=e.ee,o=e.k,u=e.eW,l=e.eX,c=e.i,f=e.z,p=e.eY,h=e.eZ,v=e.K,y=e.e_,m=e.e$,g=e.f0,b=e.f1,A=e.dX,_=e.f2,P=e.f3,C=e.f4,k=e.eg,$=e.bb,x=e.ei,S=e.f5,E=e.em},e=>{O=e.a,j=e.b,w=e.u}],execute:function(){function d(e){var r,s,d;const{geolocation:t}=n(),l=i.phoneNumber.value,c=i.addresses.value,f=a(),p=null===(r=c[0])||void 0===r?void 0:r.address,h=null!==(s=null===(d=f.defaultShippingDetails.country)||void 0===d?void 0:d.code)&&void 0!==s?s:t.country.code;return o((()=>{if(e)return u(e.address);const r={firstName:null==p?void 0:p.firstName,lastName:null==p?void 0:p.lastName,phone:l,countryCode:(null==p?void 0:p.countryCode)||h,zoneCode:null==p?void 0:p.zoneCode};return u(r)}),[e,p,h,l])}e({a:d,u:function(e="shipping_address"){const{monorail:s,source:n,checkout:a,shop:u}=c(),q=function(){const e=l(),r=O(),{telemetryClient:s}=c();return f(function(){var d=t((function*(d,t,n=r,i=!1){const{data:a,error:o}=yield e.mutate(D,{variables:{address:p(d),origin:n,checkoutContext:t,preferred:i}});if(o||null==a||null==a.addressCreate)return s.leaveErrorBreadcrumb("Shop Pay add address mutation had an error"),{status:"failed"};const{addressCreate:u}=a;return u.userErrors.length>0?(s.leaveErrorBreadcrumb("Shop Pay add address mutation had a user error"),{status:"failed",errors:u.userErrors}):{status:"success",address:u.userAddress?h(u.userAddress):void 0}}));return function(e,r){return d.apply(this,arguments)}}(),[r,e,s])}(),F=function(){const e=l(),r=O(),{telemetryClient:s}=c();return f(function(){var d=t((function*(d,t,n,i=!1){const{data:a,error:o}=yield e.mutate(N,{variables:{id:t,address:p(d),origin:r,preferred:i,checkoutContext:n}});if(o||null==a||null==a.addressUpdate)return s.leaveErrorBreadcrumb("Shop Pay update address mutation had an error"),{status:"failed"};const{addressUpdate:u}=a;return u.userErrors.length>0?(s.leaveErrorBreadcrumb("Shop Pay update address mutation had a user error"),{status:"failed",errors:u.userErrors}):{status:"success",address:u.userAddress?h(u.userAddress):void 0}}));return function(e,r,s){return d.apply(this,arguments)}}(),[e,r,s])}(),T=function(){const e=l(),r=O();return f(function(){var s=t((function*(s,d){const{data:t,error:n}=yield e.mutate(I,{variables:{id:s,origin:r,checkoutContext:d}});if(n||null==t||null==t.addressDelete)return{status:"failed"};const{addressDelete:i}=t;return i.userErrors.length>0?{status:"failed",errors:i.userErrors}:{status:"success"}}));return function(e,r){return s.apply(this,arguments)}}(),[e,r])}(),[z,R]=v(),[V,M]=y(),[X,K]=m(),[W,Y]=g(),[Z,G]=b(),{shippingRequired:H}=A(),J=j(),[L]=_(),{updateCheckoutAddress:Q}=P(),ee=d(),{shop:{id:re,myshopifyDomain:se},source:{checkoutSessionIdentifier:de}}=c(),{cashbackState:te}=C(),ne=f((()=>{te.stale.value=!0}),[te]),ie=k(),ae=i.explicitlyPreferredShippingAddressId,oe=w(),ue=x({paymentRequiredMethod:oe,isIdealEnabledForShopPay:ie}),le=O(),ce=o((()=>({checkoutIdentifier:de,checkoutVersion:le,shopId:$(re),shopifyDomain:se})),[de,re,se,le]),fe=f(function(){var e=t((function*(e,s){if(0===z.length)throw new U("There are no shipping addresses to update!");const d=yield F(e,s,ce,!0);if("success"===d.status&&d.address){const e=z.map((e=>e.id===s?d.address:r(r({},e),{},{userPreferred:!1})));R(e),ae.value=s}return d}));return function(r,s){return e.apply(this,arguments)}}(),[z,F,R,ae,ce]),pe=f(function(){var e=t((function*(e,s,d=!1,t=!1){const n=yield q(e,ce,t?"merchant_defined":le);if("success"===n.status&&n.address){let e=!1;R([...z,n.address]);const t={};(H&&!V||"shipping_address"===s)&&(M(n.address),t.shippingAddress=B(n.address.address)),ue&&(G(n.address),t.billingAddress=n.address.address,e=H),(!X||"billing_address"===s&&J)&&(K(n.address),J&&(t.billingAddress=n.address.address)),W&&("billing_address"!==s||J)||Y(n.address),d||(yield Q(r(r({},t),{},{fallbackPhoneNumber:L}),e)),ne()}return n}));return function(r,s){return e.apply(this,arguments)}}(),[le,q,R,z,H,V,X,J,W,M,G,K,Y,Q,L,ue,ce,ne]),he=f(function(){var e=t((function*(e,s){if(0===z.length)throw new U("There are no shipping addresses to update!");const d=yield F(e,s,ce);if("success"===d.status&&d.address){const e=z.findIndex((e=>e.id===s)),t=[...z];t[e]=d.address,R(t);let n=!1;const i={};(null==V?void 0:V.id)===d.address.id&&(M(d.address),i.shippingAddress=B(d.address.address)),(null==Z?void 0:Z.id)===d.address.id&&(G(d.address),ue&&(i.billingAddress=d.address.address,n=H)),(null==X?void 0:X.id)===d.address.id&&(K(d.address),J&&(i.billingAddress=d.address.address)),(null==W?void 0:W.id)===s&&Y(d.address),yield Q(r(r({},i),{},{fallbackPhoneNumber:L}),n),Object.keys(i).length>0&&ne()}return d}));return function(r,s){return e.apply(this,arguments)}}(),[z,F,R,null==V?void 0:V.id,null==Z?void 0:Z.id,null==X?void 0:X.id,null==W?void 0:W.id,Q,L,M,G,H,K,J,Y,ue,ce,ne]),ve=f(function(){var e=t((function*(e){if("success"===(yield T(e,ce)).status){const i=z.find((r=>r.id===e)),o=z.filter((r=>r.id!==e)),l=S(o);let c=!1;if(null!=i&&i.userPreferred&&l){s.record({schemaId:"shopify_pay_payment_page_ui_interaction/1.2",payload:r(r({},E(n,a,u)),{},{action:"set_default_address_auto"})});const e=o.findIndex((e=>e.id===l.id));ae.value=l.id,o[e]=r(r({},o[e]),{},{address:r({},o[e].address),userPreferred:!0})}R(o);const f={};var d,t;(null==V?void 0:V.id)===e&&(M(null!=l?l:void 0),f.shippingAddress=null!=l&&l.address?B(l.address):B(ee.value)),(null==Z?void 0:Z.id)===e&&(G(null!=l?l:void 0),ue&&(f.billingAddress=null!==(d=null==l?void 0:l.address)&&void 0!==d?d:ee.value,c=H)),(null==X?void 0:X.id)===e&&(K(null!=l?l:void 0),J&&(f.billingAddress=null!==(t=null==l?void 0:l.address)&&void 0!==t?t:ee.value)),(null==W?void 0:W.id)===e&&Y(null!=l?l:void 0),yield Q(r(r({},f),{},{fallbackPhoneNumber:L}),c)}}));return function(r){return e.apply(this,arguments)}}(),[T,z,R,null==V?void 0:V.id,null==Z?void 0:Z.id,null==X?void 0:X.id,null==W?void 0:W.id,Q,L,s,n,a,u,ae,M,ee,G,H,K,J,Y,ue,ce]),ye=f(function(){var e=t((function*(e,s){const d={negotiateType:"async"};let t=!1;"shipping_address"===s?(M(e),d.shippingAddress=B(e.address)):J?(K(e),d.billingAddress=e.address):ue?(G(e),d.billingAddress=e.address,t=H):Y(e),yield Q(r(r({},d),{},{fallbackPhoneNumber:L}),t)}));return function(r,s){return e.apply(this,arguments)}}(),[J,Q,L,M,K,Y,G,H,ue]);return{selectedAddress:o((()=>"shipping_address"===e?V:ue?Z:J?X:W),[e,J,X,W,V,Z,ue]),setSelectedAddress:ye,saveAddress:pe,updateAddress:he,deleteAddress:ve,setDefaultAddress:fe,isAddressPreferred:f((e=>e===ae.value),[ae])}}});const D={id:"e39912303339690fce3a9a6eb1c982ecd7880ed123bdaef08d9fe2203dddcce2",type:"mutation",name:"AddressCreate",source:"mutation AddressCreate($address:AddressInput!,$checkoutContext:CheckoutContextInput!,$origin:String!,$preferred:Boolean){addressCreate(address:$address origin:$origin checkoutContext:$checkoutContext preferred:$preferred){userErrors{message field __typename}userAddress{...ShippingAddressFragment __typename}__typename}}fragment ShippingAddressFragment on Address{fields{key value __typename}id lastUsedAt requiresVerification valid userPreferred explicitlyPreferred __typename}"},I={id:"838b6474da69da7a0325eb13ac94541fb070a7d544e396727b76a9fdf5ce0339",type:"mutation",name:"AddressDelete",source:"mutation AddressDelete($id:ID!,$origin:String!,$checkoutContext:CheckoutContextInput!){addressDelete(id:$id,origin:$origin,checkoutContext:$checkoutContext){userErrors{field message __typename}__typename}}"},N={id:"eedff72d66955a3481dcdfd7ab32cf154c95afd0b6b55cfc9cb3dfb731c397cc",type:"mutation",name:"AddressUpdate",source:"mutation AddressUpdate($address:AddressInput!,$id:ID!,$origin:String!,$preferred:Boolean,$checkoutContext:CheckoutContextInput!){addressUpdate(address:$address id:$id origin:$origin preferred:$preferred checkoutContext:$checkoutContext){userErrors{field message __typename}userAddress{...ShippingAddressFragment __typename}__typename}}fragment ShippingAddressFragment on Address{fields{key value __typename}id lastUsedAt requiresVerification valid userPreferred explicitlyPreferred __typename}"};class U extends Error{constructor(...e){super(...e),s(this,"name","CannotUpdateAddressError")}}const B=e=>r(r({},e),{},{coordinates:e.coordinates})}}}))}();
